{"ast":null,"code":"/**\r\n * Serial chart module.\r\n */\nimport { __extends } from \"tslib\";\n/**\r\n * ============================================================================\r\n * IMPORTS\r\n * ============================================================================\r\n * @hidden\r\n */\n\nimport { Chart, ChartDataItem } from \"../Chart\";\nimport { ListTemplate, ListDisposer } from \"../../core/utils/List\";\nimport { Container } from \"../../core/Container\";\nimport { Series } from \"../series/Series\";\nimport { percent } from \"../../core/utils/Percent\";\nimport { ColorSet } from \"../../core/utils/ColorSet\";\nimport { registry } from \"../../core/Registry\";\nimport * as $iter from \"../../core/utils/Iterator\";\nimport * as $type from \"../../core/utils/Type\";\nimport * as $array from \"../../core/utils/Array\";\nimport { Disposer } from \"../../core/utils/Disposer\";\n/**\r\n * ============================================================================\r\n * DATA ITEM\r\n * ============================================================================\r\n * @hidden\r\n */\n\n/**\r\n * Defines a [[DataItem]] for [[SerialChart]].\r\n *\r\n * @see {@link DataItem}\r\n */\n\nvar SerialChartDataItem = function (_super) {\n  __extends(SerialChartDataItem, _super);\n  /**\r\n   * Constructor\r\n   */\n\n\n  function SerialChartDataItem() {\n    var _this = _super.call(this) || this;\n\n    _this.className = \"SerialChartDataItem\";\n\n    _this.applyTheme();\n\n    return _this;\n  }\n\n  return SerialChartDataItem;\n}(ChartDataItem);\n\nexport { SerialChartDataItem };\n/**\r\n * ============================================================================\r\n * MAIN CLASS\r\n * ============================================================================\r\n * @hidden\r\n */\n\n/**\r\n * A base class for all series-based charts, like XY, Pie, etc.\r\n *\r\n * Is not useful on its own.\r\n *\r\n * @see {@link ISerialChartEvents} for a list of available Events\r\n * @see {@link ISerialChartAdapters} for a list of available Adapters\r\n */\n\nvar SerialChart = function (_super) {\n  __extends(SerialChart, _super);\n  /**\r\n   * Constructor\r\n   */\n\n\n  function SerialChart() {\n    var _this = // Init\n    _super.call(this) || this;\n\n    _this.className = \"SerialChart\";\n    _this.colors = new ColorSet();\n    _this._usesData = false; // Create a container for series\n\n    var seriesContainer = _this.chartContainer.createChild(Container);\n\n    seriesContainer.shouldClone = false;\n    seriesContainer.width = percent(100);\n    seriesContainer.height = percent(100);\n    seriesContainer.isMeasured = false;\n    seriesContainer.layout = \"none\";\n    seriesContainer.zIndex = 2;\n    _this.seriesContainer = seriesContainer; // Create a container for bullets\n\n    var bulletsContainer = _this.chartContainer.createChild(Container);\n\n    bulletsContainer.shouldClone = false;\n    bulletsContainer.width = percent(100);\n    bulletsContainer.height = percent(100);\n    bulletsContainer.isMeasured = false;\n    bulletsContainer.zIndex = 3;\n    bulletsContainer.layout = \"none\";\n    _this.bulletsContainer = bulletsContainer; // Apply theme\n\n    _this.applyTheme();\n\n    return _this;\n  }\n\n  SerialChart.prototype.dispose = function () {\n    _super.prototype.dispose.call(this);\n\n    if (this.colors) {\n      this.colors.dispose();\n    }\n\n    if (this.patterns) {\n      this.patterns.dispose();\n    }\n  };\n  /**\r\n   * Sets defaults that instantiate some objects that rely on parent, so they\r\n   * cannot be set in constructor\r\n   */\n\n\n  SerialChart.prototype.applyInternalDefaults = function () {\n    _super.prototype.applyInternalDefaults.call(this); // Add a default screen reader title for accessibility\n    // This will be overridden in screen reader if there are any `titles` set\n\n\n    if (!$type.hasValue(this.readerTitle)) {\n      this.readerTitle = this.language.translate(\"Serial chart\");\n    }\n  };\n\n  Object.defineProperty(SerialChart.prototype, \"series\", {\n    /**\r\n     * A list of chart's series.\r\n     *\r\n     * @return Chart's series\r\n     */\n    get: function () {\n      if (!this._series) {\n        this._series = new ListTemplate(this.createSeries());\n\n        this._series.events.on(\"inserted\", this.handleSeriesAdded, this, false);\n\n        this._series.events.on(\"removed\", this.handleSeriesRemoved, this, false);\n\n        this._disposers.push(new ListDisposer(this._series, false));\n\n        this._disposers.push(this._series.template);\n      }\n\n      return this._series;\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  SerialChart.prototype.handleSeriesRemoved = function (event) {\n    var series = event.oldValue;\n    this.dataUsers.removeValue(series);\n    this.dataUsers.each(function (dataUser) {\n      dataUser.invalidateDataItems();\n    });\n\n    if (series.autoDispose) {\n      series.dispose();\n    } else {\n      series.parent = undefined;\n      series.bulletsContainer.parent = undefined;\n    } //this.feedLegend();\n\n\n    var legend = this.legend;\n\n    if (legend) {\n      var dataItems = this.legend.dataItems;\n\n      for (var i = dataItems.length - 1; i >= 0; i--) {\n        var dataItem = dataItems.getIndex(i);\n\n        if (dataItem && dataItem.dataContext == series) {\n          legend.dataItems.remove(dataItem);\n        }\n      }\n\n      for (var i = legend.data.length - 1; i >= 0; i--) {\n        var di = legend.data[i];\n\n        if (di && di == series) {\n          $array.remove(legend.data, di);\n        }\n      }\n    }\n  };\n  /**\r\n   * Decorates a new [[Series]] object with required parameters when it is\r\n   * added to the chart.\r\n   *\r\n   * @ignore Exclude from docs\r\n   * @param event  Event\r\n   */\n\n\n  SerialChart.prototype.handleSeriesAdded = function (event) {\n    var _this = this;\n\n    var series = event.newValue;\n\n    if (series.isDisposed()) {\n      return;\n    }\n\n    series.chart = this;\n    series.parent = this.seriesContainer;\n    series.bulletsContainer.parent = this.bulletsContainer;\n\n    this._dataUsers.moveValue(series);\n\n    series.addDisposer(new Disposer(function () {\n      _this.dataUsers.removeValue(series);\n    }));\n    this.handleSeriesAdded2(series);\n    this.handleLegendSeriesAdded(series);\n  };\n\n  SerialChart.prototype.handleLegendSeriesAdded = function (series) {\n    if (!series.hiddenInLegend) {\n      if (this.legend) {\n        this.legend.addData(series);\n      }\n    }\n  };\n\n  SerialChart.prototype.handleSeriesAdded2 = function (series) {\n    var _this = this;\n\n    if (!this.dataInvalid) {\n      this._disposers.push( // on exit only as data is usually passed after push\n      registry.events.once(\"exitframe\", function () {\n        if (!series.data || series.data.length == 0) {\n          series.data = _this.data;\n\n          if (series.showOnInit) {\n            series.reinit();\n            series.setPropertyValue(\"showOnInit\", false);\n            series.showOnInit = true;\n          }\n\n          if (!series.isDisposed()) {\n            series.events.once(\"datavalidated\", function () {\n              if (series.data == _this.data) {\n                series._data = [];\n              }\n            });\n          }\n        }\n      }));\n    }\n  };\n  /**\r\n   * Setups the legend to use the chart's data.\r\n   * @ignore\r\n   */\n\n\n  SerialChart.prototype.feedLegend = function () {\n    var legend = this.legend;\n\n    if (legend) {\n      var legendData_1 = [];\n      $iter.each(this.series.iterator(), function (series) {\n        if (!series.hiddenInLegend) {\n          legendData_1.push(series);\n        }\n      });\n      legend.dataFields.name = \"name\";\n      legend.data = legendData_1;\n    }\n  };\n  /**\r\n   * Creates and returns a new Series, suitable for this chart type.\r\n   *\r\n   * @return New series\r\n   */\n\n\n  SerialChart.prototype.createSeries = function () {\n    return new Series();\n  };\n\n  Object.defineProperty(SerialChart.prototype, \"colors\", {\n    /**\r\n     * @return Color list\r\n     */\n    get: function () {\n      return this.getPropertyValue(\"colors\");\n    },\n\n    /**\r\n     * Chart's color list.\r\n     *\r\n     * This list can be used by a number of serial items, like applying a new\r\n     * color for each Series added. Or, applying a new color for each slice\r\n     * of a Pie chart.\r\n     *\r\n     * Please see [[ColorSet]] for information on how you can set up to generate\r\n     * unique colors.\r\n     *\r\n     * A theme you are using may override default pre-defined colors.\r\n     *\r\n     * @param value Color list\r\n     */\n    set: function (value) {\n      this.setPropertyValue(\"colors\", value, true);\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(SerialChart.prototype, \"patterns\", {\n    /**\r\n     * @return Pattern set\r\n     */\n    get: function () {\n      return this.getPropertyValue(\"patterns\");\n    },\n\n    /**\r\n     * A [[PatternSet]] to use when creating patterned fills for slices.\r\n     *\r\n     * @since 4.7.5\r\n     * @param value  Pattern set\r\n     */\n    set: function (value) {\n      this.setPropertyValue(\"patterns\", value, true);\n    },\n    enumerable: true,\n    configurable: true\n  });\n  /**\r\n   * Copies all parameters from another [[SerialChart]].\r\n   *\r\n   * @param source Source SerialChart\r\n   */\n\n  SerialChart.prototype.copyFrom = function (source) {\n    _super.prototype.copyFrom.call(this, source);\n\n    this.series.copyFrom(source.series);\n  };\n  /**\r\n   * Hides the chart instantly and then shows it. If defaultState.transitionDuration > 0, this will result an animation in which properties of hidden state will animate to properties of visible state.\r\n   */\n\n\n  SerialChart.prototype.appear = function () {\n    _super.prototype.appear.call(this);\n\n    this.series.each(function (series) {\n      if (series.showOnInit && series.inited) {\n        series.appear();\n      }\n    });\n  };\n\n  return SerialChart;\n}(Chart);\n\nexport { SerialChart };\n/**\r\n * Register class in system, so that it can be instantiated using its name from\r\n * anywhere.\r\n *\r\n * @ignore\r\n */\n\nregistry.registeredClasses[\"SerialChart\"] = SerialChart; //# sourceMappingURL=SerialChart.js.map","map":null,"metadata":{},"sourceType":"module"}